name: Update GitHub Contributor Stats

on:
  schedule:
    - cron: '0 0 * * *' # Runs daily at midnight
  workflow_dispatch: # Allows manual triggering

jobs:
  update-stats:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Grants write permission to the contents of the repository

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Download GitHub Contributor Stats
        uses: nick-fields/retry@v3
        with:
          command: curl --compressed --fail --output github-contributor-stats.svg "https://github-contributor-stats.vercel.app/api?username=Atry&combine_all_yearly_contributions=true&hide_contributor_rank=false"
          max_attempts: 3
          timeout_minutes: 10
          retry_wait_seconds: 60
      - name: Check if there was an error
        run: |
          ! grep -q "Something went wrong!" ./github-contributor-stats.svg 
      - uses: actions4git/add-commit-push@v1

